<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ³Ø¬ÙŠÙ„ Ù„Ø§Ø¹Ø¨</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background-color: var(--bg-color, #f4f4f4);
      padding: 20px;
      direction: rtl;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
      color: var(--main-color, #0072ff);
    }
    label {
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      padding: 10px 20px;
      background-color: var(--main-color, #0072ff);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .player-list {
      margin-top: 30px;
    }
    .player-card {
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 15px;
      background-color: #fafafa;
      position: relative;
    }
    .player-card img {
      max-width: 100px;
      border-radius: 8px;
      margin-left: 10px;
    }
    .search-box {
      margin: 20px 0;
    }
    .card-actions {
      position: absolute;
      top: 10px;
      left: 10px;
    }
    .card-actions button {
      margin-left: 5px;
      padding: 5px 10px;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ‘¤ ØªØ³Ø¬ÙŠÙ„ Ù„Ø§Ø¹Ø¨ Ø¬Ø¯ÙŠØ¯</h2>

    <form id="playerForm">
      <label>ğŸ“› Ø§Ù„Ø§Ø³Ù…:</label>
      <input type="text" id="name" required>

      <label>ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</label>
      <input type="text" id="address" required>

      <label>ğŸ‚ Ø§Ù„Ø³Ù†:</label>
      <input type="number" id="age" required>

      <label>ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
      <input type="tel" id="phone" required>

      <label>ğŸ’° Ø³Ø¹Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:</label>
      <input type="number" id="price" required>

      <label>ğŸŠâ€â™‚ï¸ Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ø¨ØªÙ†:</label>
      <select id="coachName" required></select>

      <label>ğŸ©º Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©:</label>
      <input type="text" id="healthStatus" required>

      <label>ğŸ“Š Ø§Ù„Ù…Ø³ØªÙˆÙ‰:</label>
      <input type="text" id="level" required>

      <label>ğŸ“… Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±:</label>
      <input type="text" id="attendanceDays" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø³Ø¨Øª - Ø§Ù„Ø¥Ø«Ù†ÙŠÙ† - Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡" required>

      <label>ğŸ–¼ï¸ ØµÙˆØ±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨:</label>
      <input type="file" id="playerImage" accept="image/*" required>

      <button type="submit">â• ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨</button>
    </form>

    <button onclick="location.href='subscriptions.html'" style="margin-top: 15px; width: 100%;">ğŸ“„ ØªØ±Ø­ÙŠÙ„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</button>

    <div class="search-box">
      <label>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù„Ø§Ø¹Ø¨:</label>
      <input type="text" id="searchBox" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨...">
    </div>

    <div class="player-list" id="playerList"></div>
  </div>

  <script>
    const form = document.getElementById("playerForm");
    const coachSelect = document.getElementById("coachName");
    const playerList = document.getElementById("playerList");
    const searchBox = document.getElementById("searchBox");
    const user = JSON.parse(localStorage.getItem("currentUser"));

    if (user && user.plan === "vip") {
      const vipColor = localStorage.getItem("vipColor");
      if (vipColor) {
        document.documentElement.style.setProperty('--main-color', vipColor);
      }
    }

    const coaches = JSON.parse(localStorage.getItem("coaches")) || [];
    coaches.forEach(coach => {
      const option = document.createElement("option");
      option.value = coach.name;
      option.textContent = coach.name;
      coachSelect.appendChild(option);
    });

    function renderPlayers(filter = "") {
      const players = JSON.parse(localStorage.getItem("players")) || [];
      playerList.innerHTML = "";

      players.filter(p => p.name.includes(filter)).forEach((player, index) => {
        const card = document.createElement("div");
        card.className = "player-card";
        card.innerHTML = `
          <div class="card-actions">
            <button onclick="editPlayer(${index})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
            <button onclick="deletePlayer(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
          </div>
          <div style="display: flex; align-items: center;">
            <img src="${player.image}" alt="ØµÙˆØ±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨">
            <div>
              <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${player.name}</p>
              <p><strong>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</strong> ${player.address}</p>
              <p><strong>Ø§Ù„Ø³Ù†:</strong> ${player.age}</p>
              <p><strong>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${player.phone}</p>
              <p><strong>Ø³Ø¹Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:</strong> ${player.price} Ø¬Ù†ÙŠÙ‡</p>
              <p><strong>Ø§Ù„ÙƒØ§Ø¨ØªÙ†:</strong> ${player.coach}</p>
              <p><strong>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­ÙŠØ©:</strong> ${player.health}</p>
              <p><strong>Ø§Ù„Ù…Ø³ØªÙˆÙ‰:</strong> ${player.level}</p>
              <p><strong>Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±:</strong> ${player.days}</p>
              <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> ${player.date}</p>
            </div>
          </div>
        `;
        playerList.appendChild(card);
      });
    }

    form.addEventListener("submit", function(e) {
      e.preventDefault();

      const name = document.getElementById("name").value;
      const address = document.getElementById("address").value;
      const age = document.getElementById("age").value;
      const phone = document.getElementById("phone").value;
      const price = document.getElementById("price").value;
      const coach = coachSelect.value;
      const health = document.getElementById("healthStatus").value;
      const level = document.getElementById("level").value;
      const days = document.getElementById("attendanceDays").value;
      const imageFile = document.getElementById("playerImage").files[0];

      if (!imageFile) return;

      const reader = new FileReader();
      reader.onload = function(event) {
        const player = {
          name,
          address,
          age,
          phone,
          price,
          coach,
          health,
          level,
          days,
          image: event.target.result,
          date: new Date().toLocaleDateString()
        };

        const players = JSON.parse(localStorage.getItem("players")) || [];
        players.push(player);
        localStorage.setItem("players", JSON.stringify(players));
        form.reset();
        renderPlayers();
      };

      reader.readAsDataURL(imageFile);
    });

    function deletePlayer(index) {
      const players = JSON.parse(localStorage.getItem("players")) || [];
      if (confirm("âŒ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¹Ø¨ØŸ")) {
        players.splice(index, 1);
        localStorage.setItem("players", JSON.stringify(players));
        renderPlayers();
      }
    }

    function editPlayer(index) {
      const players = JSON.parse(localStorage.getItem("players")) || [];
      const player = players[index];
      document.getElementById("name").value = player.name;
      document.getElementById("address").value = player.address;
      document.getElementById("age").value = player.age;
      document.getElementById("phone").value = player.phone;
      document.getElementById("price").value = player.price;
      document.getElementById("coachName").value = player.coach;
      document.getElementById("healthStatus").value = player.health;
      document.getElementById("level").value = player.level;
      document.getElementById("attendanceDays").value = player.days;

      // Ø­Ø°Ù Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø«Ù… Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø¶Ø§ÙØªÙ‡ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
      players.splice(index, 1);
      localStorage.setItem("players", JSON.stringify(players));
      renderPlayers();
    }

    searchBox.addEventListener("input", function() {
      renderPlayers(this.value.trim());
    });

    renderPlayers();
  </script>
  <script>
  const currentUser = JSON.parse(localStorage.getItem("currentUser") || "{}");

  if (currentUser.status === "banned" || currentUser.status === "suspended") {
    const msg = currentUser.status === "banned"
      ? `<div class="message banned"><h2>ğŸš« Ù„Ù‚Ø¯ ØªÙ… Ø­Ø¸Ø±Ùƒ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù…</h2><p>Ø¨Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p></div>`
      : `<div class="message suspended"><h2>â¸ï¸ Ø­Ø³Ø§Ø¨Ùƒ Ù…ÙˆÙ‚ÙˆÙ Ù…Ø¤Ù‚ØªÙ‹Ø§</h2><p>ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø£Ùˆ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p></div>`;
    document.write(`<html><head><title>Ø§Ù„Ø­Ø§Ù„Ø©</title></head><body>${msg}</body></html>`);
  }
</script>

  <button class="btn" style="margin-top: 30px; width: 100%;" onclick="location.href='pool-management.html'">â¬…ï¸ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
</body>
</html>
